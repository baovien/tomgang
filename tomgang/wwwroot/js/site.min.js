function updateIntervals(){window.isInitialized&&window.upgrades!==undefined?(getPlayerInfo(),setInterval(function(){var n=(new Date).getTime(),t=0;window.lastCall!==undefined&&(t=(n-window.lastCall)*.001);window.lastCall=n;window.currentGains+=window.incomeValue*t;$("#gainNumber").text(Math.floor(window.currentGains));updateUpgradesStatus();updateItemsStatus()},100),setInterval(function(){getPlayerInfo();getUnlockedAchis();getEligibleUpgrades();increaseGains();getHighscoreValues();updateHighscoreTab();updateAchievementsTab();updateItemsCost()},5e3)):(console.log(window.isInitialized),console.log(window.upgrades),setTimeout(updateIntervals,500))}function getCurrentGains(){window.hub.server.getCurrentGains().done(function(n){window.currentGains=n})}function getEligibleUpgrades(){window.hub.server.checkUpgrades().done(function(n){window.upgrades=n})}function getHighscoreValues(){window.hub.server.getHighscore().done(function(n){window.highscore=n})}function getUnlockedAchis(){window.hub.server.checkAchis().done(function(n){window.achis=n})}function increaseGains(){window.hub.server.increaseGains()}function getPlayerInfo(){window.hub.server.getUserInfo().done(function(n){window.currentGains=n.currentGains;window.incomeValue=n.incomeValue;window.clickValue=n.clickValue;window.totalGains=n.totalGains;window.timesClicked=n.timesClicked;window.timeJoined=n.timeJoined;$("#gpsec").text(window.incomeValue);$("#gplift").text(Math.floor(window.clickValue));$("#totgains").text(Math.floor(window.totalGains));$("#timesClicked").text(window.timesClicked);$("#joindate").text(window.timeJoined)})}function updateHighscoreTab(){var n=0,t=$("#hstable tbody tr").length;window.highscore.forEach(function(i){$("#addr"+n).html("<td class='pos'>"+(n+1)+"<\/td><td class='name'>"+i.item1+" <\/td><td class='score'>"+Math.floor(i.item2)+"<\/td>");t<window.highscore.length&&$("#hstable").append('<tr id="addr'+(n+1)+'"><\/tr>');console.log($("#hstable tbody > tr"));$("#hstable tbody tr").sort(function(n,t){return+$("td.score",t).text()>+$("td.score",n).text()}).appendTo("tbody").find("td:first").text(function(n){return++n});n++},this)}function liftClickPost(){$("#benchman").click(function(){window.hub.server.liftClick().done(function(){window.currentGains+=window.clickValue});$("#gainNumber").text(Math.floor(window.currentGains));$("#timesClicked").text(+window.timesClicked+1);$(this).on({mousedown:function(){$(this).attr("src",$("#Weights").attr("data-weightimg")+"up.png")},mouseup:function(){$(this).attr("src",$("#Weights").attr("data-weightimg")+"down.png")}})})}function autoLift(){}function updateBenchWeight(){var t=$("#Weights").attr("data-amount"),n;console.log(t);n=t/10|0;n>5&&(n=5);$("#Weights").attr("data-weightimg","images/benchman/bench"+n);$("#benchman").attr("src","images/benchman/bench"+n+"down.png")}function updateGainsCounter(){$("#gainNumber").text(Math.floor(window.currentGains))}function updateUpgradesStatus(){window.upgrades.forEach(function(n){window.currentGains<=n.item2?($('[id="'+n.item1+'"]').addClass("upgradeGreyed"),$('[id="'+n.item1+'"]').css({"background-color":""})):($('[id="'+n.item1+'"]').removeClass("upgradeGreyed"),$('[id="'+n.item1+'"]').css({"background-color":"lightgreen"}));$('[id="'+n.item1+'"]').show()})}function upgradeBtnsPost(){$(".upgradeImg").each(function(){$(this).on("click",function(){console.log("Upgrade click");getPlayerInfo();var n=this,t=window.currentGains;t>=this.dataset.cost&&($(n).hide(),window.hub.server.upgradeClick($(n).attr("id")).done(function(t){console.log(t);t?($(n).remove(),$(".popover").remove()):$(n).show()}),$("#gainNumber").text(Math.floor(t-this.dataset.cost)),updateUpgradesStatus())})})}function updateItemsStatus(){$(".item").each(function(){window.currentGains<this.dataset.cost?($(this).addClass("upgradeGreyed"),$(this).css({"background-color":""})):($(this).removeClass("upgradeGreyed"),$(this).css({"background-color":"lightgreen"}));$(this).show()})}function updateItemsCost(){$(".item").each(function(){var n=this;window.hub.server.getSingleItemAmount($(n).attr("id")).done(function(t){n.dataset.cost=n.dataset.startingprice*Math.exp(.14*t);n.dataset.amount=t;$("font",n).text(t);$("#itemprice",n).text("Price: "+Math.round(n.dataset.cost));updateBenchWeight();updateItemsStatus()})})}function itemBtnsPost(){$(".item").each(function(){$(this).on("click",function(){console.log("Item click");var n=this,t=window.currentGains;t>=this.dataset.cost&&(n.dataset.amount++,window.currentGains-=n.dataset.cost,n.dataset.cost=n.dataset.startingprice*Math.exp(.14*n.dataset.amount),$("#itemprice",n).text("Price: "+Math.round(n.dataset.cost)),$("#gainNumber").text(Math.floor(window.currentGains)),$("font",n).text(n.dataset.amount),n.dataset.name=="Weights"&&updateBenchWeight(),window.hub.server.itemClick($(this).attr("id")).done(function(){}))})})}function updateAchievementsTab(){var n,t,i;if(window.achis!==undefined)for(n=0;n<window.achis.length;n++)t=document.getElementById(window.achis[n]),window.achis[n]!==$(t).attr("id")||(i=$(t).attr("data-imgPath"),$(t).attr("src",i))}function signalr(){window.hub=$.connection.broadcaster;$.connection.broadcaster.client.addChatMessage=addPost;$.connection.hub.logging=!0;$.connection.hub.start().done(function(n){console.log("Connected!");console.log("SignalR object: ",n);window.hub.server.getUserInfo().done(function(n){window.currentGains=n.currentGains;window.incomevalue=n.incomeValue;window.clickValue=n.clickValue;window.totalGains=n.totalGains;window.timesClicked=n.timesClicked;window.timeJoined=n.timeJoined;window.isInitialized=!0;$("#gpsec").text(window.incomeValue);$("#gplift").text(Math.floor(window.clickValue));$("#totgains").text(Math.floor(window.totalGains));$("#timesClicked").text(window.timesClicked);$("#joindate").text(window.timeJoined);updateGainsCounter();updateItemsCost();liftClickPost();upgradeBtnsPost();itemBtnsPost()});window.hub.server.checkUpgrades().done(function(n){window.upgrades=n;updateUpgradesStatus()});window.hub.server.checkAchis().done(function(n){window.achis=n});window.hub.server.getHighscore().done(function(n){window.highscore=n;updateHighscoreTab()});window.hub.server.subscribe("MainChatroom")}).fail(function(n){console.log("Failed to start connection! Error: ",n)});$("#textInput").keypress(function(n){n.keyCode==13&&$("#publishPostButton").click()});$("#publishPostButton").click(function(){if($("#textInput").val()!==""){var n={content:$("#textInput").val()};$.ajax({headers:{"Content-Type":"application/json"},type:"POST",url:"/chatroom/",data:JSON.stringify(n),dataType:"json"}).fail(function(n){console.log(n)});$("#textInput").val("")}})}function addPostsList(n){$.each(n,function(t){var r=n[t],i=n;addPost(i)})}function addPost(n){console.log("New post from server: ",n);$("#postsList").append("<li>("+n.timestamp.substring(11,16)+") "+n.author+": "+n.content+"<\/li>");var t=$("#postsList").get(0);t.scrollTop=t.scrollHeight}function getPostList(){$.ajax({url:"/chatroom/",method:"GET",dataType:"JSON",success:addPostsList})}$(document).ready(function(){$(".upgradeImg, .achiImg").popover();$(".btn-pref .btn").click(function(){$(".btn-pref .btn").removeClass("btn-primary").addClass("btn-default");$(this).removeClass("btn-default").addClass("btn-primary")});$("#login-form-link").click(function(n){$("#login-form").delay(100).fadeIn(100);$("#register-form").fadeOut(100);$("#register-form-link").removeClass("active");$(this).addClass("active");n.preventDefault()});$("#register-form-link").click(function(n){$("#register-form").delay(100).fadeIn(100);$("#login-form").fadeOut(100);$("#login-form-link").removeClass("active");$(this).addClass("active");n.preventDefault()});$("#login-dp").click(function(n){n.stopPropagation()});$("#letsgoleft").click(function(){$("#testlols").load("Manage/ChangePassword",$("#testlols").serialize());$("#goback").show()});$("#goback").click(function(){$("#testlols").load("Manage/Index",$("#testlols").serialize());$("#goback").hide()})});